(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90533,e=>{"use strict";let t=(0,e.i(14560).default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],90533)},32254,e=>{"use strict";let t=(0,e.i(14560).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);e.s(["Camera",()=>t],32254)},56245,e=>{"use strict";var t=e.i(79071),a=e.i(91176),r=e.i(55187),s=e.i(90533),i=e.i(32254),l=e.i(14560);let o=(0,l.default)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),d=(0,l.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function c(){let e=(0,a.useRouter)(),l=(0,a.usePathname)();return(0,t.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 bg-green-600 px-4 py-2 flex justify-around items-center",children:[(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:()=>e.push("/materials"),className:`flex flex-col items-center gap-1 p-2 ${"/materials"===l?"text-white":"text-green-100"}`,children:[(0,t.jsx)(s.FileText,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-xs",children:"Materials"})]}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:()=>e.push("/scan"),className:`flex flex-col items-center gap-1 p-2 ${"/scan"===l?"text-white":"text-green-100"}`,children:[(0,t.jsx)(i.Camera,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-xs",children:"Scan"})]}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:()=>e.push("/leaderboard"),className:`flex flex-col items-center gap-1 p-2 ${"/leaderboard"===l?"text-white":"text-green-100"}`,children:[(0,t.jsx)(o,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-xs",children:"Leaderboard"})]}),(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",onClick:()=>e.push("/user"),className:`flex flex-col items-center gap-1 p-2 ${"/user"===l?"text-white":"text-green-100"}`,children:[(0,t.jsx)(d,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-xs",children:"User"})]})]})}e.s(["BottomNavigation",()=>c],56245)},24797,e=>{"use strict";e.i(16161);var t=e.i(7253),a=e.i(1371);let r="materials",s=async(e,s)=>{if(!a.db)throw Error("Firebase Firestore not initialized");try{return(await (0,t.addDoc)((0,t.collection)(a.db,r),{ownerUid:e,materialName:s.materialName,howToRecycle:s.howToRecycle,discoveredAt:t.Timestamp.fromDate(s.discoveredAt),similarMaterials:s.similarMaterials,imagePath:s.imagePath,audioPath:s.audioPath,createdAt:(0,t.serverTimestamp)(),updatedAt:(0,t.serverTimestamp)()})).id}catch(e){throw console.error("Error creating material:",e),e}},i=async(e,s={})=>{if(!a.db)throw Error("Firebase Firestore not initialized");try{let i,l=(0,t.query)((0,t.collection)(a.db,r),(0,t.where)("ownerUid","==",e),(0,t.orderBy)("discoveredAt","desc"));s.limit&&(l=(0,t.query)(l,(0,t.limit)(s.limit))),s.cursor&&(l=(0,t.query)(l,(0,t.startAfter)(s.cursor)));let o=await (0,t.getDocs)(l),d=[];return o.forEach(e=>{let t=e.data(),a={id:e.id,ownerUid:t.ownerUid,materialName:t.materialName,howToRecycle:t.howToRecycle,discoveredAt:t.discoveredAt?.toDate()||new Date,similarMaterials:t.similarMaterials||[],imagePath:t.imagePath,audioPath:t.audioPath,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()||new Date};(!s.search||a.materialName.toLowerCase().includes(s.search.toLowerCase()))&&d.push(a)}),o.docs.length>0&&(i=o.docs[o.docs.length-1]),{materials:d,nextCursor:i}}catch(e){throw console.error("Error listing materials:",e),e}},l=async(e,s)=>{if(!a.db)throw Error("Firebase Firestore not initialized");try{let i=(0,t.doc)(a.db,r,s),l=await (0,t.getDoc)(i);if(!l.exists())return null;let o=l.data();if(o.ownerUid!==e)throw Error("Unauthorized access to material");return{id:l.id,ownerUid:o.ownerUid,materialName:o.materialName,howToRecycle:o.howToRecycle,discoveredAt:o.discoveredAt?.toDate()||new Date,similarMaterials:o.similarMaterials||[],imagePath:o.imagePath,audioPath:o.audioPath,createdAt:o.createdAt?.toDate()||new Date,updatedAt:o.updatedAt?.toDate()||new Date}}catch(e){throw console.error("Error getting material:",e),e}},o=async(e,s,i)=>{if(!a.db)throw Error("Firebase Firestore not initialized");try{let l=(0,t.doc)(a.db,r,s),o=await (0,t.getDoc)(l);if(!o.exists()||o.data().ownerUid!==e)throw Error("Unauthorized access to material");let d={...i,updatedAt:(0,t.serverTimestamp)()};i.discoveredAt&&(d.discoveredAt=t.Timestamp.fromDate(i.discoveredAt)),await (0,t.updateDoc)(l,d)}catch(e){throw console.error("Error updating material:",e),e}},d=async(e,s)=>{if(!a.db)throw Error("Firebase Firestore not initialized");try{let i=(0,t.doc)(a.db,r,s),l=await (0,t.getDoc)(i);if(!l.exists()||l.data().ownerUid!==e)throw Error("Unauthorized access to material");await (0,t.deleteDoc)(i)}catch(e){throw console.error("Error deleting material:",e),e}},c=async e=>{if(!a.db)throw Error("Firebase Firestore not initialized");try{let s=(0,t.query)((0,t.collection)(a.db,r),(0,t.where)("ownerUid","==",e)),i=(await (0,t.getDocs)(s)).size,l=new Date;l.setDate(l.getDate()-7);let o=(0,t.query)((0,t.collection)(a.db,r),(0,t.where)("ownerUid","==",e),(0,t.where)("discoveredAt",">=",t.Timestamp.fromDate(l)),(0,t.orderBy)("discoveredAt","asc")),d=(await (0,t.getDocs)(o)).size;return{totalDiscovered:i,discoveredThisWeek:d,points:i}}catch(e){throw console.error("Error computing user stats:",e),e}};e.s(["createMaterial",0,s,"deleteMaterial",0,d,"getMaterial",0,l,"getUserStats",0,c,"listMaterials",0,i,"updateMaterial",0,o])},99238,e=>{"use strict";var t=e.i(79071),a=e.i(58277),r=e.i(91176),s=e.i(38926),i=e.i(55187),l=e.i(56245),o=e.i(24797);function d(){let[e,d]=(0,a.useState)(null),[c,n]=(0,a.useState)(!0),[h,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(""),[p,g]=(0,a.useState)(!1),[y,w]=(0,a.useState)(null),b=(0,r.useRouter)();if((0,a.useEffect)(()=>(0,s.onAuthStateChange)(async e=>{if(d(e),u(e?.displayName||""),e)try{let t=await (0,o.getUserStats)(e.uid);w(t)}catch{w(null)}n(!1),e||b.push("/")}),[b]),c)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})});if(!e)return null;let f=(e.displayName||"You").split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase();return(0,t.jsxs)("div",{className:"min-h-screen bg-white pb-20",children:[(0,t.jsx)("div",{className:"bg-white border-b border-gray-200 px-4 py-4",children:(0,t.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Your Profile"})}),(0,t.jsxs)("div",{className:"px-4 py-6 max-w-md mx-auto",children:[(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[e.photoURL?(0,t.jsx)("img",{src:e.photoURL,alt:e.displayName||"User",className:"w-16 h-16 rounded-full object-cover"}):(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center text-green-700 font-bold",children:f}),(0,t.jsxs)("div",{className:"flex-1",children:[h?(0,t.jsx)("input",{value:x,onChange:e=>u(e.target.value),className:"block w-full border border-gray-300 rounded-lg px-3 py-2 text-base",placeholder:"Display name",maxLength:50}):(0,t.jsx)("p",{className:"text-base font-semibold text-gray-900",children:e.displayName||"Anonymous"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,t.jsx)(i.Button,{variant:"outline",className:"w-full",onClick:async()=>{await (0,s.signOutUser)(),b.push("/")},children:"Sign out"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[(0,t.jsxs)("div",{className:"text-center bg-white border border-gray-200 rounded-xl p-4",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:y?y.totalDiscovered:"—"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Discovered"})]}),(0,t.jsxs)("div",{className:"text-center bg-white border border-gray-200 rounded-xl p-4",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:y?y.discoveredThisWeek:"—"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"This Week"})]}),(0,t.jsxs)("div",{className:"text-center bg-white border border-gray-200 rounded-xl p-4",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:y?y.points:"—"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Points"})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:h?(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl p-4 space-y-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{value:x,onChange:e=>u(e.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2",placeholder:"Display name",maxLength:50}),(0,t.jsx)(i.Button,{disabled:p||!x.trim()||x.trim()===(e?.displayName||""),onClick:async()=>{if(e)try{g(!0),await (0,s.updateDisplayName)(e,x),m(!1)}finally{g(!1)}},children:p?"Saving...":"Save"}),(0,t.jsx)(i.Button,{variant:"outline",onClick:()=>{m(!1),u(e?.displayName||"")},children:"Cancel"})]})}):(0,t.jsx)("button",{className:"w-full text-left bg-white border border-gray-200 rounded-xl p-4",onClick:()=>m(!0),children:"Edit Display Name"})})]}),(0,t.jsx)(l.BottomNavigation,{})]})}e.s(["default",()=>d])}]);